<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Bed Management</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .card-bed { margin-bottom: 1rem; }
    .badge-status { font-size: 0.9em; }
    .dashboard-card { min-width: 180px; }
    .bed-icon { background: #0d6efd1a; border-radius: 50%; padding: 0.7rem; }
  </style>
</head>
<body class="bg-light">
<div class="container py-4">
  <h2 class="mb-4 fw-bold">Bed Management</h2>
  <!-- Dashboard Cards -->
  <div class="row mb-4">
    <div class="col dashboard-card">
      <div class="card text-center shadow-sm">
        <div class="card-body">
          <div class="fs-4 fw-bold"><%= beds.length %></div>
          <div>Total Beds</div>
        </div>
      </div>
    </div>
    <div class="col dashboard-card">
      <div class="card text-center shadow-sm">
        <div class="card-body">
          <div class="fs-4 fw-bold text-danger">
            <%= beds.filter(b => b.status === 'occupied').length %>
          </div>
          <div>Occupied Beds</div>
        </div>
      </div>
    </div>
    <div class="col dashboard-card">
      <div class="card text-center shadow-sm">
        <div class="card-body">
          <div class="fs-4 fw-bold text-success">
            <%= beds.filter(b => b.status === 'available').length %>
          </div>
          <div>Available Beds</div>
        </div>
      </div>
    </div>
  </div>
  <!-- Add Bed Button -->
  <div class="d-flex justify-content-end mb-3">
    <a href="/beds/new" class="btn btn-success">+ Add Bed</a>
  </div>
  <!-- Bed Cards -->
  <% beds.forEach(bed => { %>
    <div class="card card-bed shadow-sm">
      <div class="card-body d-flex align-items-center">
        <div class="me-3">
          <span class="bed-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#0d6efd" class="bi bi-hospital" viewBox="0 0 16 16">
              <path d="M6.5.5a.5.5 0 0 1 .5.5v2h2V1a.5.5 0 0 1 1 0v2h2V1a.5.5 0 0 1 1 0v2h.5A1.5 1.5 0 0 1 15 4.5v10a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-10A1.5 1.5 0 0 1 2.5 3H3V1a.5.5 0 0 1 1 0v2h2V1a.5.5 0 0 1 .5-.5zm-4 4A.5.5 0 0 0 2 5v9h12V5a.5.5 0 0 0-.5-.5h-11zm2.5 2a.5.5 0 0 1 .5.5v1h1a.5.5 0 0 1 0 1h-1v1a.5.5 0 0 1-1 0v-1h-1a.5.5 0 0 1 0-1h1v-1a.5.5 0 0 1 .5-.5z"/>
            </svg>
          </span>
        </div>
        <div class="flex-grow-1">
          <div class="fw-bold fs-5"><%= bed.bedId %></div>
          <div class="text-muted mb-1">
            <span class="me-3"><i class="bi bi-building"></i> <%= bed.ward %> Ward</span>
            <span class="me-3"><i class="bi bi-door-open"></i> Room <%= bed.room %></span>
            <span><i class="bi bi-layers"></i> Floor <%= bed.floor %></span>
          </div>
          <div class="row">
            <div class="col-auto">
              <div class="small text-secondary">Status</div>
              <span class="badge badge-status 
                <% if(bed.status === 'available'){ %> bg-success <% } %>
                <% if(bed.status === 'occupied'){ %> bg-danger <% } %>
              ">
                <%= bed.status %>
              </span>
            </div>
            <div class="col-auto">
              <div class="small text-secondary">Doctor</div>
              <div class="fw-semibold"><%= bed.doctor || '-' %></div>
            </div>
            <div class="col-auto">
              <div class="small text-secondary">Condition</div>
              <div class="fw-semibold"><%= bed.condition || '-' %></div>
            </div>
            <% if(bed.status === 'occupied' && bed.patient) { %>
            <div class="col-auto">
              <div class="small text-secondary">Patient</div>
              <div class="fw-semibold"><%= bed.patient.name %> (<%= bed.patient.id %>)</div>
            </div>
            <% } %>
          </div>
        </div>
        <div class="ms-3 text-end">
          <a href="/beds/<%= bed._id %>/edit" class="btn btn-outline-primary btn-sm mb-2">Edit</a><br>
          <form action="/beds/<%= bed._id %>?_method=DELETE" method="POST" style="display:inline;">
            <button type="submit" class="btn btn-outline-danger btn-sm">Delete</button>
          </form>
        </div>
      </div>
    </div>
  <% }) %>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"></script>
<!-- Bootstrap Icons CDN -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
</body>
</html>